{% extends 'base.html' %}
{% load cms_tags thumbnail %}

{% block title %}{{ member.name }} · Team · Solak{% endblock %}

{% block content %}
<section class="relative overflow-hidden">
  <div class="pointer-events-none absolute inset-0 bg-[radial-gradient(circle_at_20%_20%,rgba(20,184,166,.2),transparent_45%),radial-gradient(circle_at_80%_10%,rgba(251,191,36,.22),transparent_40%)]"></div>
  <div class="relative mx-auto grid max-w-7xl gap-10 px-4 py-10 sm:px-6 lg:grid-cols-12 lg:gap-12 lg:px-8 lg:py-16">
    <figure id="tilt-card" class="reveal group lg:col-span-5">
      <div class="glass shadow-glow relative overflow-hidden rounded-3xl border border-white/30 p-2 dark:border-white/10">
        {% if member.photo %}
          {% thumbnail member.photo 900x1100 crop upscale format='WEBP' as hero %}
          <img src="{{ hero.url }}" width="{{ hero.width }}" height="{{ hero.height }}" alt="{{ member.name }}" loading="eager" class="h-full min-h-[420px] w-full rounded-[1.3rem] object-cover transition duration-500 group-hover:scale-105" />
        {% else %}
          <div class="flex min-h-[420px] items-center justify-center rounded-[1.3rem] bg-slate-200 text-slate-500 dark:bg-slate-800">No image yet</div>
        {% endif %}
      </div>
    </figure>

    <div class="reveal lg:col-span-7 lg:pt-8">
      <p class="mb-2 inline-flex items-center gap-2 rounded-full border border-brand-bright/40 bg-brand-bright/10 px-3 py-1 text-xs font-semibold uppercase tracking-[0.18em] text-brand-deep dark:text-brand-bright">Team profile · 2026</p>
      <h1 class="kinetic-text bg-gradient-to-r from-brand-deep via-brand-bright to-brand-solar bg-clip-text font-heading text-4xl font-extrabold leading-tight text-transparent sm:text-6xl">{{ member.name }}</h1>
      <p class="mt-2 text-lg font-semibold text-slate-700 dark:text-slate-300">{{ member.role }}</p>
      <p class="mt-5 max-w-2xl text-base leading-relaxed text-slate-600 dark:text-slate-300">{{ member.tagline|default:member.short_bio }}</p>

      <div class="mt-7 grid gap-3 sm:grid-cols-2 xl:grid-cols-4">
        {% if member.email %}<a class="glass rounded-2xl border border-white/30 px-4 py-3 text-sm font-medium hover:scale-[1.02]" href="mailto:{{ member.email }}">{{ member.email }}</a>{% endif %}
        {% if member.phone %}<a class="glass rounded-2xl border border-white/30 px-4 py-3 text-sm font-medium hover:scale-[1.02]" href="tel:{{ member.phone }}">{{ member.phone }}</a>{% endif %}
        {% if member.linkedin %}<a class="glass rounded-2xl border border-white/30 px-4 py-3 text-sm font-medium hover:scale-[1.02]" href="{{ member.linkedin }}" target="_blank" rel="noopener">LinkedIn</a>{% endif %}
        {% if member.twitter %}<a class="glass rounded-2xl border border-white/30 px-4 py-3 text-sm font-medium hover:scale-[1.02]" href="{{ member.twitter }}" target="_blank" rel="noopener">X / Twitter</a>{% endif %}
      </div>
    </div>
  </div>
</section>

<section class="mx-auto grid max-w-7xl gap-10 px-4 pb-16 sm:px-6 lg:grid-cols-12 lg:px-8">
  <article class="reveal lg:col-span-8">
    <h2 class="font-heading text-2xl font-bold">Biography</h2>
    <div class="prose prose-slate mt-4 max-w-none dark:prose-invert">
      {{ member.full_bio|safe }}
    </div>

    <div class="mt-12 space-y-8">
      <div>
        <h3 class="font-heading text-xl font-semibold">Testimonials</h3>
        {% placeholder "member_testimonials" %}
      </div>
      <div>
        <h3 class="font-heading text-xl font-semibold">Projects</h3>
        {% placeholder "member_projects" %}
      </div>
      <div>
        <h3 class="font-heading text-xl font-semibold">Call to action</h3>
        {% placeholder "member_cta" %}
      </div>
    </div>
  </article>

  <aside class="reveal lg:col-span-4">
    <h2 class="font-heading text-2xl font-bold">Core skills</h2>
    <div class="mt-6 grid grid-cols-2 gap-4">
      {% for skill in member.skills.all %}
      <div class="group rounded-3xl border border-slate-200/80 bg-white p-4 text-center shadow-sm transition hover:-translate-y-1 dark:border-slate-800 dark:bg-slate-900">
        <div class="mx-auto mb-3 h-24 w-24 rounded-full" style="background: conic-gradient(#14b8a6 calc({{ skill.percentage }} * 1%), #e2e8f0 0);">
          <div class="flex h-full w-full items-center justify-center rounded-full border-[10px] border-white bg-slate-50 text-lg font-bold dark:border-slate-900 dark:bg-slate-950">{{ skill.percentage }}%</div>
        </div>
        <p class="text-sm font-semibold">{{ skill.name }}</p>
      </div>
      {% empty %}
      <p class="text-sm text-slate-500">No skills added yet.</p>
      {% endfor %}
    </div>
  </aside>
</section>

<section class="mx-auto max-w-7xl px-4 pb-20 sm:px-6 lg:px-8">
  <div class="reveal mb-6 flex items-end justify-between">
    <h2 class="font-heading text-2xl font-bold">Related members</h2>
    <a href="{% url 'core:member-list' %}" class="text-sm font-medium text-brand-deep hover:text-brand-bright">View all</a>
  </div>
  <div class="grid grid-cols-2 gap-4 md:grid-cols-3 lg:grid-cols-6">
    {% for related in related_members %}
    <a href="{{ related.get_absolute_url }}" class="reveal group relative overflow-hidden rounded-3xl">
      {% if related.photo %}
        {% thumbnail related.photo 500x640 crop upscale format='AVIF' as thumb %}
        <img src="{{ thumb.url }}" alt="{{ related.name }}" loading="lazy" class="h-52 w-full object-cover transition duration-500 group-hover:scale-110" />
      {% else %}
        <div class="h-52 w-full bg-slate-200 dark:bg-slate-800"></div>
      {% endif %}
      <div class="absolute inset-0 flex items-end bg-gradient-to-t from-black/70 via-transparent to-transparent p-3 text-white">
        <div>
          <p class="text-sm font-semibold">{{ related.name }}</p>
          <p class="text-xs opacity-80">{{ related.role }}</p>
        </div>
      </div>
    </a>
    {% endfor %}
  </div>
</section>

<script>
  const tiltCard = document.getElementById('tilt-card');
  if (tiltCard) {
    tiltCard.addEventListener('mousemove', (e) => {
      const r = tiltCard.getBoundingClientRect();
      const x = (e.clientX - r.left) / r.width - 0.5;
      const y = (e.clientY - r.top) / r.height - 0.5;
      tiltCard.style.transform = `perspective(1000px) rotateY(${x * 8}deg) rotateX(${y * -8}deg)`;
    });
    tiltCard.addEventListener('mouseleave', () => tiltCard.style.transform = 'perspective(1000px) rotateY(0) rotateX(0)');
  }
</script>
{% endblock %}
